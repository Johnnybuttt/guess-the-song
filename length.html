<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'; object-src 'none'; base-uri 'self';">
  <title>Guess The Song â€” Settings</title>
  <link rel="stylesheet" href="app.css">
</head>
<body>
<div class="container">
  <h1>Settings</h1>

  <div class="card">
    <p class="small">Clip length</p>
    <div class="row" id="lengths"></div>

    <div class="hr"></div>

    <p class="small">Song pool</p>
    <div class="row" id="pool"></div>

    <div class="hr"></div>

    <div class="row">
      <button class="secondary" onclick="history.back()">Back</button>
      <button id="start">Start Game</button>
    </div>
  </div>
</div>

<script>
  // Clip length
  const lengths = [10, 30, 60];
  let selectedLen = Number(localStorage.getItem("clip") || 30);
  const lengthsEl = document.getElementById("lengths");

  function renderLengths() {
    lengthsEl.innerHTML = "";
    lengths.forEach(l => {
      const d = document.createElement("div");
      d.className = "pill" + (l === selectedLen ? " selected" : "");
      d.textContent = l + " seconds";
      d.onclick = () => { selectedLen = l; renderLengths(); };
      lengthsEl.appendChild(d);
    });
  }

  // Song pool
  const pools = [
    { key: "top", label: "Your songs" },
    { key: "random", label: "Random songs" }
  ];
  let selectedPool = localStorage.getItem("song_pool") || "top";
  const poolEl = document.getElementById("pool");

  function renderPools() {
    poolEl.innerHTML = "";
    pools.forEach(p => {
      const d = document.createElement("div");
      d.className = "pill" + (p.key === selectedPool ? " selected" : "");
      d.textContent = p.label;
      d.onclick = () => { selectedPool = p.key; renderPools(); };
      poolEl.appendChild(d);
    });
  }

  renderLengths();
  renderPools();

  document.getElementById("start").onclick = () => {
    localStorage.setItem("clip", selectedLen);
    localStorage.setItem("song_pool", selectedPool);
    window.location.href = "game.html";
  };
</script>
</body>
</html>
